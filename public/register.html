<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registrarse - QuinchoFinder</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>

    <header class="header">
        <a href="/" class="logo">
          <img src="/images/quincho-finder-logo.png" alt="QuinchoFinder" />
          
        </a>
        <nav class="nav">
          <a href="/" class="active">Inicio</a>
          <a href="/register.html">Registrarse</a>
          <a href="/login.html" class="btn-primary">Iniciar Sesión</a>
        </nav>
      </header>

<main class="auth-container">
  <h2>Crear cuenta</h2>

  <form id="register-form" class="auth-form">
    <label>Nombre Completo</label>
    <input type="text" name="nombre" required />

    <label>Email</label>
    <input type="email" name="email" required />

    <label>Contraseña</label>
    <input type="password" name="password" required />

    <label>Confirmar Contraseña</label>
    <input type="password" name="password2" required />

    <button type="submit" class="btn-primary btn-submit">Registrarse</button>

    <p class="auth-switch">
      ¿Ya tenés cuenta? <a href="/login.html">Iniciar sesión</a>
    </p>

    <p id="register-message"></p>
  </form>
</main>

<footer class="footer">
  <p>&copy; 2025 QuinchoFinder.</p>
</footer>

<script>
  document.getElementById("register-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const msg = document.getElementById("register-message");

    if (e.target.password.value !== e.target.password2.value) {
      msg.style.color = "red";
      msg.textContent = "Las contraseñas no coinciden.";
      return;
    }

    const formData = {
      nombre: e.target.nombre.value,
      email: e.target.email.value,
      password: e.target.password.value,
    };

    try {
      const response = await fetch("/api/auth/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData),
      });

      const data = await response.json();

      if (response.ok) {
        msg.style.color = "green";
        msg.textContent = "Cuenta creada. Redirigiendo...";
        setTimeout(() => (window.location.href = "/login.html"), 1000);
      } else {
        msg.style.color = "red";
        msg.textContent = data.error || "Error al registrarse.";
      }
    } catch {
      msg.style.color = "red";
      msg.textContent = "Error de conexión.";
    }
  });
</script>

</body>
</html>
