<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Iniciar Sesión - QuinchoFinder</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>

<header class="header">
  <a href="/" class="logo">
    <img src="/images/quincho-finder-logo.png" alt="QuinchoFinder" />
    QuinchoFinder
  </a>
  <nav class="nav">
    <a href="/">Inicio</a>
    <a href="/register.html">Registrarse</a>
  </nav>
</header>

<main class="auth-container">
  <h2>Iniciar Sesión</h2>

  <form id="login-form" class="auth-form">
    <label>Email</label>
    <input type="email" name="email" required />

    <label>Contraseña</label>
    <input type="password" name="password" required />

    <button type="submit" class="btn-primary btn-submit">Ingresar</button>

    <p class="auth-switch">
      ¿No tenés cuenta? <a href="/register.html">Registrate acá</a>
    </p>

    <p id="login-message"></p>
  </form>
</main>

<footer class="footer">
  <p>&copy; 2025 QuinchoFinder.</p>
</footer>

<script>
  document.getElementById("login-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = {
      email: e.target.email.value,
      password: e.target.password.value,
    };

    const message = document.getElementById("login-message");

    try {
      const response = await fetch("/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData),
      });

      const data = await response.json();

      if (response.ok) {
        message.style.color = "green";
        message.textContent = "Inicio de sesión exitoso. Redirigiendo...";
        setTimeout(() => (window.location.href = "/anfitrion/dashboard.html"), 1000);
      } else {
        message.style.color = "red";
        message.textContent = data.error || "Error al iniciar sesión.";
      }
    } catch {
      message.style.color = "red";
      message.textContent = "Error de conexión con el servidor.";
    }
  });
</script>

</body>
</html>
